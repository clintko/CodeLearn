---
title: "Learn Dynamic Factor Analysis"
author: "Ko, Kuei Yueh"
date: "Thursday, July 23, 2015"
output: html_document
---


```{r}
#install.packages("mvtnorm")
#install.packages("MARSS")
library(dygraphs)
library(MARSS)
```

We will analyze some of the Lake Washington plankton data included in the
MARSS package. This dataset includes 33 years of monthly counts for 13
plankton species along with data on water temperature, total phosphorous
(TP), and pH. First, we load the data and then extract a subset of columns
corresponding to the phytoplankton species only. For the purpose of speeding
up model fitting times and to limit our analysis to years with no missing
covariate data, we will only examine 10 years of data (1980-1989).
```{r}
# load the data (there are 3 datasets contained here)
data(lakeWAplankton)
```

```{r}
nhtemp

temp <- matrix(dat[,"Temp"], ncol=12)
rownames(temp) <- unique(dat[,"Year"])
colnames(temp) <- 1:12

temp <- ts(data=temp, start=1962, end=1994, frequency=12)
temp
dygraph(temp, main = "Lake Temperatures")
?
```


```{r}
# we want lakeWAplanktonTrans, which has been transformed
# so the 0s are replaced with NAs and the data z-scored
dat = lakeWAplanktonTrans
# use only the 10 years from 1980-1989
plankdat = dat[dat[,"Year"]>=1980 & dat[,"Year"]<1990,]
# create vector of phytoplankton group names
phytoplankton = c("Cryptomonas", "Diatoms", "Greens",
"Unicells", "Other.algae")
# get only the phytoplankton
dat.spp.1980 = plankdat[,phytoplankton]
```

Next, we transpose the data and calculate the number of time series and their
length.
```{r}
# transpose data so time goes across columns
dat.spp.1980 = t(dat.spp.1980)
# get number of time series
N.ts = dim(dat.spp.1980)[1]
# get length of time series
TT = dim(dat.spp.1980)[2]
```

